<!DOCTYPE HTML>
<!--
	Helios by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Spatial Weight Matrix Estimation</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
        
        <!-- SEO -->
         <meta name="author" content="Philipp Otto, Rick Steinert" />
         <meta name="description" content="Explainer of a two-stage adaptive LASSO method to estimate full spatial weight matrices in spatiotemporal autoregressive models while accounting for location-specific structural breaks in the mean." />
         <meta name="keywords" content="spatial weights, structural breaks, spatiotemporal autoregression, adaptive LASSO, SAR models, change points, statistical learning, Otto, Steinert, JCGS 2022" />
         <link rel="canonical" href="https://doi.org/10.1080/10618600.2022.2107530"/>

         <!-- Open Graph -->
         <meta property="og:title" content="Estimating Spatial Weights with Structural Breaks" />
         <meta property="og:description" content="Two-stage adaptive LASSO for spatial weight matrix estimation under structural breaks in spatiotemporal data." />
         <meta property="og:type" content="article" />
         <meta property="og:url" content="https://doi.org/10.1080/10618600.2022.2107530" />

         <!-- Schema.org -->
         <script type="application/ld+json">
         {
           "@context":"https://schema.org",
           "@type":"ScholarlyArticle",
           "name":"Estimation of the Spatial Weighting Matrix for Spatiotemporal Data under the Presence of Structural Breaks",
           "author":[
             {"@type":"Person","name":"Philipp Otto"},
             {"@type":"Person","name":"Rick Steinert"}
           ],
           "datePublished":"2022-10-04",
           "isPartOf":{"@type":"Periodical","name":"Journal of Computational and Graphical Statistics"},
           "identifier":"https://doi.org/10.1080/10618600.2022.2107530",
           "url":"https://doi.org/10.1080/10618600.2022.2107530",
           "keywords":["spatial weights","spatiotemporal autoregressive models","structural breaks","adaptive LASSO","change-point detection"]
         }
         </script>

         <!-- MathJax (equations below) -->
         <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
         
         
	</head>
	<body class="right-sidebar is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<div id="header">

					<!-- Inner -->
						<div class="inner">
							<header>
								<h1><a href="index.html" id="logo">Selected papers</a></h1>
							</header>
						</div>

					<!-- Nav -->
                    <nav id="nav">
                        <ul>
                            <li><a href="index.html">Home</a></li>
<!--                                <li>
                                <a href="#">Dropdown</a>
                                <ul>
                                    <li><a href="#">Lorem ipsum dolor</a></li>
                                    <li><a href="#">Magna phasellus</a></li>
                                    <li><a href="#">Etiam dolore nisl</a></li>
                                    <li>
                                        <a href="#">And a submenu &hellip;</a>
                                        <ul>
                                            <li><a href="#">Lorem ipsum dolor</a></li>
                                            <li><a href="#">Phasellus consequat</a></li>
                                            <li><a href="#">Magna phasellus</a></li>
                                            <li><a href="#">Etiam dolore nisl</a></li>
                                        </ul>
                                    </li>
                                    <li><a href="#">Veroeros feugiat</a></li>
                                </ul>
                            </li>
-->
                            <li><a href="research.html">Research</a>
                                <ul>
                                    <li><a href="research.html">Publications</a></li>
                                    <li><a href="projects.html">Projects</a></li>
                                    <li><a href="presentations.html">Presentations</a></li>
                                </ul>
                            </li>
                            <li><a href="teaching.html">Teaching</a></li>
                            <li><a href="cv.html">Curriculum Vitae</a></li>
                            <li><a href="team.html">Team</a></li>
                            <li><a href="consulting.html">Consulting</a></li>
                        </ul>
                    </nav>

				</div>

			<!-- Main -->
				<div class="wrapper style1">

					<div class="container">
						<div class="row gtr-200">
							<div class="col-8 col-12-mobile" id="content">
								<article id="main">
									<header>
										<h2><a href="https://arxiv.org/abs/1810.06940">Estimation of the Spatial Weighting Matrix for Spatiotemporal Data under the Presence of Structural Breaks</a></h2>
										<p>
                                        <strong>Otto, P.</strong>, Steinert, R. (2019): Estimation of the Spatial Weighting Matrix for Spatiotemporal Data under the Presence of Structural Breaks, Journal of Computational and Graphical Statistics <a href="https://arxiv.org/abs/1810.06940">(arXiv)</a>
										</p>
									</header>
                                    <h3>Abstract</h3>
                                    <p>
                                    In this paper, we propose a two-stage LASSO estimation approach for the estimation of a full spatial weights matrix of spatiotemporal autoregressive models. In addition, we allow for an unknown number of structural breaks in the local means of each spatial location. These locally varying mean levels, however, can easily be mistaken as spatial dependence and vice versa. Thus, the proposed approach jointly estimates the spatial dependence, all structural breaks, and the local mean levels. For selection of the penalty parameter, we propose a completely new selection criterion based on the distance between the empirical spatial autocorrelation and the spatial dependence estimated in the model. Through simulation studies, we will show the finite-sample performance of the estimators and provide practical guidance as to when the approach could be applied. Finally, the invented method will be illustrated by an empirical example of regional monthly real-estate prices in Berlin between 1995 and 2014. The spatial units will be defined by the respective ZIP codes. The new approach allows us to estimate local mean levels and quantify the deviation of the observed prices from these levels due to spatial spillover effects.
                                    </p>
                                    
                                    
                                    <section>
                                        <h3>Background</h3>
                                        <p>
                                          Spatial autoregressive (SAR) and related models require a spatial weighting matrix \(W\). In practice, \(W\) is often assumed
                                          or selected from a small candidate set, which risks misspecification. This work proposes a data-driven method to
                                          <em>estimate the full matrix \(W\)</em> while also allowing for an unknown number of <em>location-specific structural breaks</em> in the mean.
                                        </p>
                                      </section>

                                      <section>
                                        <h3>Key takeaways</h3>
                                        <ul>
                                          <li><strong>Joint problem:</strong> Spatial dependence and mean breaks can be easily confounded. The method estimates both simultaneously.</li>
                                          <li><strong>Two-stage adaptive LASSO:</strong> Stage 1 finds candidate change points per location; Stage 2 estimates \(W\) and local mean paths with constraints.</li>
                                          <li><strong>Model-based selection of \(\lambda\):</strong> A criterion aligns sample and model-implied spatial autocorrelation to choose the penalty parameter.</li>
                                          <li><strong>Output:</strong> A sparse, interpretable estimate of \(W\) (nonnegative, row sums \(\le 1\)) and location-wise mean trajectories over time.</li>
                                          <li><strong>Use cases:</strong> Panels with possible regime shifts (policy, markets) where spatial link strength and directionality are unknown.</li>
                                        </ul>
                                      </section>

                                      <section>
                                        <h3>Intuition</h3>
                                        <p>
                                          If means jump at different times across locations, those jumps can mimic spatial spillovers; conversely, strong spatial spillovers
                                          can look like simultaneous breaks. The estimator separates these by first over-detecting plausible change points in each local series,
                                          then letting the full spatiotemporal model retain only those needed while estimating \(W\).
                                        </p>
                                      </section>

                                      <section>
                                        <h3>Model</h3>
                                        <p>
                                          Observations at time \(t=1,\dots,T\) and locations \(s_1,\dots,s_n\):
                                        </p>
                                        <p>
                                        \[
                                          Y_t = W Y_t + a_t + \varepsilon_t,\quad \varepsilon_t \sim \mathcal{N}(0,\sigma^2 I_n),\qquad
                                          \text{with } \rho(W) < 1,\; \mathrm{diag}(W)=0,\; W\ge 0.
                                        \]
                                        </p>
                                        <p>
                                          The vector \(a_t\) collects location-specific mean levels that may change at unknown times (structural breaks, not necessarily synchronized across locations).
                                          Reduced form:
                                        </p>
                                        <p>
                                        \[
                                          Y_t = (I - W)^{-1} a_t + (I - W)^{-1}\varepsilon_t.
                                        \]
                                        </p>
                                      </section>

                                      <section>
                                        <h3>Estimation (two-stage adaptive LASSO)</h3>
                                        <ol>
                                          <li><strong>Stage 1: change-point candidates (per location).</strong>
                                            For each location \(i\), fit a lower-triangular “step” design with adaptive LASSO to detect level changes in the overall mean trajectory
                                            \(\alpha_{t,i}\) (which already contains spillovers). Collect candidate change times \(\mathcal{T}^{(1)}_i\).</li>
                                          <li><strong>Stage 2: joint estimation of \(W\) and local means.</strong>
                                            Stack all times/locations and solve a constrained LASSO:
                                            \[
                                              \min_{\tilde a,\;\xi}\;\|Z\xi + \Phi \tilde a - y\|_2^2 + \lambda_b \|\xi\|_1,
                                            \]
                                            subject to \( \tilde a_{t,i}=0\) for \(t\notin \mathcal{T}^{(1)}_i\), \(w_{ii}=0\), \(w_{ij}\ge 0\), and \(\sum_j w_{ij}\le 1\) for all \(i\).
                                            Here \( \xi=\mathrm{vec}(W)\), \( \Phi\) maps change increments to levels, and \(Z = I_n \otimes Y\).</li>
                                        </ol>
                                      </section>

                                      <section>
                                        <h3>Penalty selection</h3>
                                        <p>
                                          Standard CV on prediction error can neglect spatial error correlation. The paper proposes selecting \(\lambda_b\) by matching
                                          the <em>sample spatial autocorrelation</em> (from mean-adjusted data) with the <em>model-implied spatial autocorrelation</em>
                                          (from \((I-W)^{-1}\varepsilon\)), e.g., via an MAE between correlation matrices. This targets the correct strength and pattern of \(W\).
                                        </p>
                                      </section>

                                      <section>
                                        <h3>Practical guidance</h3>
                                        <ul>
                                          <li><strong>Diagnostics:</strong> If residual maps suggest level shifts at different times across locations, and SAR estimates depend heavily on the chosen \(W\),
                                            consider this estimator.</li>
                                          <li><strong>Weights interpretation:</strong> Estimated links need not be purely geographic; they may reflect network or functional proximity.
                                            Inspect on a map or network graph.</li>
                                          <li><strong>Directionality:</strong> In short panels with few breaks, one-way links can be partially mirrored (weak reverse links). Focus on the stronger edge.</li>
                                          <li><strong>Constraints:</strong> Nonnegativity and row-sum \(\le 1\) stabilize estimation and ensure \((I-W)\) invertibility in practice.</li>
                                        </ul>
                                      </section>

                                      <section>
                                        <h3>Application</h3>
                                        <p>
                                        The method is illustrated with Berlin condominium prices (1995–2014),
                                              where both spatial spillovers and structural breaks are evident.
                                              It detected location-specific regime shifts (e.g. around the 2008 financial crisis)
                                              and recovered a spatial weights matrix \(W\) that highlighted heterogeneous connections between districts.
                                              Importantly, the analysis shows that intra-city dependence often extends beyond simple geographical proximity,
                                              reflecting similarities in culture, lifestyle, or socio-economic conditions.
                                              This provides a more realistic picture of market dynamics than standard SAR models with pre-specified weights
                                              and is particularly valuable for real-estate pricing, where overlooking such hidden dependencies can lead
                                              to biased valuations and misguided investment or policy decisions.
                                              The approach is broadly relevant for urban economics, finance, and regional studies,
                                              where simultaneous spatial spillovers and regime changes are common.
                                        </p>
                                      </section>
                                      
                                      
                                      
                                    <a href="https://www.scimagojr.com/journalsearch.php?q=23863&amp;tip=sid&amp;exact=no" title="SCImago Journal &amp; Country Rank"><img border="0" src="https://www.scimagojr.com/journal_img.php?id=23863" alt="SCImago Journal &amp; Country Rank"  /></a>
								</article>
							</div>
                            
							<div class="col-4 col-12-mobile" id="sidebar">
								<hr class="first" />
								<section>
                                    <header>
                                        <h3><a href="#">Research interests</a></h3>
                                    </header>
                                    <p>
                                        I am interested in statistical data science and statistical methodology for data in multidimensional spaces, e.g., geo-referenced data. Most of my papers have one theory in common - Tobler's first law of geography: "everything is related to everything else, but near things are more related than distant things."
                                    </p>
                                    <div class="row gtr-50">
                                        <div class="col-4">
                                            <a href="#" class="image fit"><img src="images/ststat.jpg" alt="" /></a>
                                        </div>
                                        <div class="col-8">
                                            <h4>Spatiotemporal statistics</h4>
                                            <p>
                                                Spatial econometric modelling, spatiotemporal GARCH models, computational statistics
                                            </p>
                                        </div>
                                        <div class="col-4">
                                            <a href="#" class="image fit"><img src="images/statlearn.jpg" alt="" /></a>
                                        </div>
                                        <div class="col-8">
                                            <h4>Statistical learning</h4>
                                            <p>
                                                Estimation of spatial weights, big geospatial data, spatiotemporal LASSO
                                            </p>
                                        </div>
                                        <div class="col-4">
                                            <a href="#" class="image fit"><img src="images/env.jpg" alt="" /></a>
                                        </div>
                                        <div class="col-8">
                                            <h4>Environmetrics</h4>
                                            <p>
                                                Functional geostatistical modelling, bootstrapping procedures, profile modelling
                                            </p>
                                        </div>
                                        <div class="col-4">
                                            <a href="#" class="image fit"><img src="images/spc.jpg" alt="" /></a>
                                        </div>
                                        <div class="col-8">
                                            <h4>Statistical process control</h4>
                                            <p>
                                                Control charts under spatiotemporal dependence, monitoring deep learning algorithms
                                            </p>
                                        </div>
                                        <div class="col-4">
                                            <a href="#" class="image fit"><img src="images/network.jpg" alt="" /></a>
                                        </div>
                                        <div class="col-8">
                                            <h4>Network modelling</h4>
                                            <p>
                                                Exponential random graphs models, change detection in graphs, neural networks
                                            </p>
                                        </div>
                                    </div>
								</section>
								<hr />
								<section>
									<header>
										<h3><a href="#">Current projects</a></h3>
									</header>
									<p>
										Information about the external research funding can be found here:
									</p>
									
									<footer>
										<a href="projects.html" class="button">More details</a>
									</footer>
								</section>
                                <hr />
                                <section>
                                    <header>
                                        <h3><a href="#">Other IDs:</a></h3>
                                    </header>
                                    <p>
                                        ORCID: <a href="https://orcid.org/0000-0002-9796-6682">0000-0002-9796-6682</a>
                                    </p>
                                    <p>
                                        ResearcherID: <a href="https://publons.com/researcher/P-7870-2015/">P-7870-2015</a>
                                    </p>
                                    <p>
                                        Scopus: <a href="https://www.scopus.com/authid/detail.uri?authorId=57210684279">57210684279</a>
                                    </p>
                                    <p>
                                        Google Scholar: <a href="https://scholar.google.de/citations?user=URsnzm8AAAAJ">URsnzm8AAAAJ</a>
                                    </p>
                                    <p>
                                        ResearchGate: <a href="https://www.researchgate.net/profile/Philipp-Otto-2">Philipp-Otto-2</a>
                                    </p>
                                    <p>
                                        Loop: <a href="https://loop.frontiersin.org/people/1156815/overview">1156815</a>
                                    </p>
                                </section>
                                <hr />
                                <section>
                                    <header>
                                        <h3><a href="#">My arXiv publications</a></h3>
                                    </header>
                                    <p>
                                         I usually publish all my research first on arXiv open access:
                                    </p>
                                    
                                    <footer>
                                        <a href="https://arxiv.org/a/otto_p_1.html" class="button">arXiv</a>
                                    </footer>
                                </section>
							</div>
						</div>
						
                        
						
					</div>

				</div>

                <!-- Footer -->
                    <div id="footer">
    <!--                    <div class="container">-->
    <!--                        <div class="row">-->
    <!--                            <!-- Tweets -->
    <!--                                <section class="col-4 col-12-mobile">-->
    <!--                                    <header>-->
    <!--                                        <h2 class="icon brands fa-twitter circled"><span class="label">Tweets</span></h2>-->
    <!--                                    </header>-->
    <!--                                    <ul class="divided">-->
    <!--                                        <li>-->
    <!--                                            <article class="tweet">-->
    <!--                                                Amet nullam fringilla nibh nulla convallis tique ante sociis accumsan.-->
    <!--                                                <span class="timestamp">5 minutes ago</span>-->
    <!--                                            </article>-->
    <!--                                        </li>-->
    <!--                                        <li>-->
    <!--                                            <article class="tweet">-->
    <!--                                                Hendrerit rutrum quisque.-->
    <!--                                                <span class="timestamp">30 minutes ago</span>-->
    <!--                                            </article>-->
    <!--                                        </li>-->
    <!--                                        <li>-->
    <!--                                            <article class="tweet">-->
    <!--                                                Curabitur donec nulla massa laoreet nibh. Lorem praesent montes.-->
    <!--                                                <span class="timestamp">3 hours ago</span>-->
    <!--                                            </article>-->
    <!--                                        </li>-->
    <!--                                        <li>-->
    <!--                                            <article class="tweet">-->
    <!--                                                Lacus natoque cras rhoncus curae dignissim ultricies. Convallis orci aliquet.-->
    <!--                                                <span class="timestamp">5 hours ago</span>-->
    <!--                                            </article>-->
    <!--                                        </li>-->
    <!--                                    </ul>-->
    <!--                                </section>-->
    <!---->
    <!--                            <!-- Posts -->
    <!--                                <section class="col-4 col-12-mobile">-->
    <!--                                    <header>-->
    <!--                                        <h2 class="icon solid fa-file circled"><span class="label">Posts</span></h2>-->
    <!--                                    </header>-->
    <!--                                    <ul class="divided">-->
    <!--                                        <li>-->
    <!--                                            <article class="post stub">-->
    <!--                                                <header>-->
    <!--                                                    <h3><a href="#">Nisl fermentum integer</a></h3>-->
    <!--                                                </header>-->
    <!--                                                <span class="timestamp">3 hours ago</span>-->
    <!--                                            </article>-->
    <!--                                        </li>-->
    <!--                                        <li>-->
    <!--                                            <article class="post stub">-->
    <!--                                                <header>-->
    <!--                                                    <h3><a href="#">Phasellus portitor lorem</a></h3>-->
    <!--                                                </header>-->
    <!--                                                <span class="timestamp">6 hours ago</span>-->
    <!--                                            </article>-->
    <!--                                        </li>-->
    <!--                                        <li>-->
    <!--                                            <article class="post stub">-->
    <!--                                                <header>-->
    <!--                                                    <h3><a href="#">Magna tempus consequat</a></h3>-->
    <!--                                                </header>-->
    <!--                                                <span class="timestamp">Yesterday</span>-->
    <!--                                            </article>-->
    <!--                                        </li>-->
    <!--                                        <li>-->
    <!--                                            <article class="post stub">-->
    <!--                                                <header>-->
    <!--                                                    <h3><a href="#">Feugiat lorem ipsum</a></h3>-->
    <!--                                                </header>-->
    <!--                                                <span class="timestamp">2 days ago</span>-->
    <!--                                            </article>-->
    <!--                                        </li>-->
    <!--                                    </ul>-->
    <!--                                </section>-->
    <!---->
    <!--                            <!-- Photos -->
    <!--                                <section class="col-4 col-12-mobile">-->
    <!--                                    <header>-->
    <!--                                        <h2 class="icon solid fa-camera circled"><span class="label">Photos</span></h2>-->
    <!--                                    </header>-->
    <!--                                    <div class="row gtr-25">-->
    <!--                                        <div class="col-6">-->
    <!--                                            <a href="#" class="image fit"><img src="images/pic10.jpg" alt="" /></a>-->
    <!--                                        </div>-->
    <!--                                        <div class="col-6">-->
    <!--                                            <a href="#" class="image fit"><img src="images/pic11.jpg" alt="" /></a>-->
    <!--                                        </div>-->
    <!--                                        <div class="col-6">-->
    <!--                                            <a href="#" class="image fit"><img src="images/pic12.jpg" alt="" /></a>-->
    <!--                                        </div>-->
    <!--                                        <div class="col-6">-->
    <!--                                            <a href="#" class="image fit"><img src="images/pic13.jpg" alt="" /></a>-->
    <!--                                        </div>-->
    <!--                                        <div class="col-6">-->
    <!--                                            <a href="#" class="image fit"><img src="images/pic14.jpg" alt="" /></a>-->
    <!--                                        </div>-->
    <!--                                        <div class="col-6">-->
    <!--                                            <a href="#" class="image fit"><img src="images/pic15.jpg" alt="" /></a>-->
    <!--                                        </div>-->
    <!--                                    </div>-->
    <!--                                </section>-->
    <!--                        </div>-->
    <!--                        <hr />-->
                            <div class="row">
                                <div class="col-12">

                                    <!-- Contact -->
                                        <section class="contact">
                                            <header>
                                                <h3>Missing anything?</h3>
                                            </header>
                                            <p>You can also find my profiles here:</p>
                                            <ul class="icons">
                                                <li><a href="https://www.researchgate.net/profile/Philipp-Otto-2" class="icon brands fa-researchgate"><span class="label">ResearchGate</span></a></li>
                                                <li><a href="https://www.instagram.com/stats.o.phil.e/" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
                                                <li><a href="https://www.linkedin.com/in/philipp-otto-0a9887264/" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li>
                                                <li><a href="https://www.xing.com/profile/Philipp_Otto8/cv" class="icon brands fa-xing"><span class="label">Xing</span></a></li>
                                                <li><a href="https://twitter.com/PhilOt5" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
                                            </ul>
                                        </section>

                                    <!-- Copyright -->
                                        <div class="copyright">
                                            <ul class="menu">
                                                <li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
                                            </ul>
                                        </div>

                                </div>

                            </div>
                        </div>
                    </div>

            </div>
            
		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
